<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="valued_report_picking" name="Custom Document Report Picking Valued"
              inherit_id="stock_picking_report_valued.valued_report_picking">
        <xpath expr="//t[@t-set='address']" position="replace"/>
        <xpath expr="//div[@class='page']" position="before">
            <div class="address row">
                <div name="invoice_address" class="col-7">
                    <address t-field="o.partner_id"
                             t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
                    <div t-if="o.partner_id.vat" class="mt16"><t t-esc="o.company_id.country_id.vat_label or 'TIN'"/>:
                        <span t-field="o.partner_id.vat"/>
                    </div>
                </div>

                <div name="picking_information" class="col-5">
                    <div class="row">
                        <div class="col-7 text-left">
                            <span>Albarán:</span>
                        </div>
                        <div class="col-5 text-right">
                            <span t-field="o.name"/>
                        </div>
                    </div>
                    <div t-if="o.scheduled_date" class="row">
                        <div class="col-5 text-left">Fecha:</div>
                        <div class="col-7 text-right">
                            <span t-field="o.scheduled_date"/>
                        </div>
                    </div>
                    <div t-if="o.origin"
                         class="row">
                        <div class="col-7 text-left">Pedido:</div>
                        <div class="col-5 text-right">
                            <span t-field="o.origin"/>
                        </div>
                    </div>
                    <div t-if="o.weight"
                         class="row">
                        <div class="col-7 text-left">Peso:</div>
                        <div class="col-5 text-right">
                            <span t-field="o.weight"/>
                            <span t-field="o.weight_uom_id"/>
                        </div>
                    </div>
                    <div t-if="o.invoice_ids" class="row">
                        <div class="col-6 text-left">Factura:</div>
                        <div class="col-6 text-right">
                            <span t-field="o.invoice_ids"/>
                        </div>
                    </div>
                </div>
            </div>
            <br/>
        </xpath>
        <xpath expr="//h2" position="replace"/>
        <xpath expr="//div[@class='page']/table[@class='table table-sm']" position="replace"/>
        <xpath expr="//table[@class='table table-condensed mt32']" position="replace">
            <t t-if="o.valued and o.sale_id and o.move_line_ids">
                <div class="clearfix">
                    <div id="total" class="row">
                        <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                            <table class="table table-sm" style="page-break-inside: avoid;">
                                <tr class="border-black o_subtotal" style="">
                                    <td>
                                        <strong>Subtotal</strong>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="o.amount_untaxed"/>
                                    </td>
                                </tr>
                                <tr style="">
                                    <td>Taxes</td>
                                    <td class="text-right o_price_total">
                                        <span t-esc="o.amount_tax"/>
                                    </td>
                                </tr>
                                <tr class="border-black o_total" style="background-color: #1176D9; color: #fafaf8;">
                                    <td>
                                        <strong>Total</strong>
                                    </td>
                                    <td class="text-right">
                                        <span t-field="o.amount_total"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </t>
        </xpath>
        <xpath expr="//div[@class='clearfix']" position="after">
            <t t-if="o.invoice_ids">
                <br/>
                <span style="color: #1176D9;">
                    <b>Información sobre el pago</b>
                </span>
                <div class="row">
                    <div class="col-3 text-left">Forma de pago:</div>
                    <div class="col-3 text-right">
                        <span t-field="o.invoice_ids.payment_mode_id"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-3 text-left">Vencimiento:</div>
                    <div class="col-3 text-right">
                        <span t-field="o.invoice_ids.date_due"/>
                    </div>
                </div>
                <br/>
                <span class="row">
                    <div class="col-5" style="color: #1176D9;">
                        <b>Impuesto</b>
                    </div>
                    <div class="col-7 border-bottom">
                        <b>Cuentas</b>
                    </div>
                </span>
                <div class="row">
                    <div class="col-5">
                        <table class="table table-sm" style="page-break-inside: avoid;">
                            <t t-foreach="o.invoice_ids.amount_by_group" t-as="amount_by_group">
                                <t t-if="len(o.invoice_ids.tax_line_ids) == 1 and o.invoice_ids.amount_untaxed == amount_by_group[2]">
                                    <tr>
                                        <td class="text-left">
                                            <span>Tipo IVA:</span>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="amount_by_group[0]"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="text-left">
                                            <span>Importe IVA:</span>
                                        </td>
                                        <td class="text-right">
                                            <span t-esc="amount_by_group[3]"/>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                        </table>
                    </div>
                    <div class="col-7">
                        <t t-foreach="o.invoice_ids.payment_mode_id.variable_journal_ids" t-as="cuenta">
                            <div class="row">
                                <div class="col-5 text-left">
                                    <span t-field="cuenta.name"/>
                                </div>
                                <div class="col-7 text-right">
                                    <span t-field="cuenta.bank_acc_number"/>
                                </div>
                            </div>
                        </t>
                    </div>
                </div>
            </t>
        </xpath>
    </template>

</odoo>